"use strict";
// Usage CRYSTALLIZE_ACCESS_TOKEN_ID=xxx CRYSTALLIZE_ACCESS_TOKEN_SECRET=xxx CRYSTALLIZE_TENANT_IDENTIFIER=xxx node dist/examples/dump-tenant.js
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const __1 = require("../");
const dumper_1 = require("../core/dump-tenant/dumper");
const massCallClient_1 = require("../core/massCallClient");
const fs_1 = __importDefault(require("fs"));
const onFailure = async (batch, exception, promise) => {
    console.log(`Failure in batch from ${batch.from} to ${batch.to}: ${exception.message}`);
    return true;
};
const client = (0, massCallClient_1.createMassCallClient)(__1.CrystallizeClient, {
    initialSpawn: 5000,
    maxSpawn: 10000,
    onFailure,
});
async function run() {
    const dumper = (0, dumper_1.createDumper)(client, { tenantIdentifier: 'furniture' });
    const spec = await dumper.dump();
    try {
        fs_1.default.writeFileSync('./plopnew.spec.json', JSON.stringify(spec));
    }
    catch (err) {
        console.error(err);
    }
}
run();
//# sourceMappingURL=dump-tenant.js.map